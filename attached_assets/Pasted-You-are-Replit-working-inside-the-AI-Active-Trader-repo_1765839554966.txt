You are Replit working inside the AI Active Trader repository.

CURRENT STATE (DO NOT RE-DO):
- Phase 0+1 critical gaps fixed: G1 work queue order ops, G2 traceId propagation, G3 worker startup. Confirm but do not rebuild. (See AUDIT_DOC_VS_IMPLEMENTATION_GAP.md.)
- Moderate gaps remain: G4 (orders vs trades vs fills conflated) and G5 (event-driven saga docs are future-state). Keep them in backlog if not yet implemented, but your Admin Center MUST surface them clearly.

PRIMARY GOAL (Task 3):
Create a WordPress-like Admin Center that controls and monitors everything:
- Orchestrator + schedules + runs
- Work queue + dead letters + retries
- Events/outbox (if present)
- LLM routing (OpenAI vs OpenRouter) + costs + failures
- Providers + budgets + caching + cache inspector
- Trading truth surfaces (Decisions, Intents, Orders, Fills, Positions) and reconciliation
- Trade forensics: what went right/wrong, anomalies, stuck states, mismatch counts
…and enforce “Docs vs Reality” with an auto-generated compliance report.

NON-NEGOTIABLE RULES:
1) NO HALLUCINATION: every “done” must be proven via diff + endpoint responses + DB evidence.
2) Admin UI must show REAL data only (DB or broker APIs) and label “source” + fetchedAt.
3) Do not duplicate existing components; consolidate/reuse.
4) Any doc that claims a feature exists must either:
   - point to the implementation (and it works), or
   - be updated to mark it as Future/Planned.

========================================================
PHASE A — FULL DOCS + MIGRATION PLAN + REALITY MAP (REQUIRED FIRST)
========================================================
A1) Read ALL docs in /docs (including:
- WORK_QUEUE_ARCHITECTURE.md
- OBSERVABILITY.md
- SOURCE_OF_TRUTH_CONTRACT.md
- TRADING_SAGA_SEQUENCES.md
- ORCHESTRATOR_AND_AGENT_RUNTIME.md
- MICROSERVICES_ROADMAP.md
- AI_MODELS_AND_PROVIDERS.md
- any ADRs / INDEX.md / TODO docs
Also read AUDIT_DOC_VS_IMPLEMENTATION_GAP.md and treat it as the ground-truth audit.

A2) Build “Doc ↔ Reality Matrix”:
For each doc section:
- claim
- expected code path (file/function/endpoint/table)
- status: VERIFIED / PARTIAL / MISSING / DOC-OUTDATED
- evidence link: file path + endpoint + sample row IDs

A3) Extract ALL “TODO / Planned / Next phase / Future / backlog” items and create a single backlog JSON in:
- docs/ADMIN_BACKLOG.json
Include priority, risk, and dependencies.
Ensure G4 and G5 are present and correctly described (audit says they remain). 

A4) Output in Replit console a short summary:
- Top 10 mismatches
- Top 10 next items
- What you will implement in this task vs defer

========================================================
PHASE B — WORDPRESS-LIKE ADMIN CENTER FOUNDATION (PLUGIN/MODULE ARCH)
========================================================
Target: an admin shell that works like WP admin:
- left nav with sections/subsections
- a Settings framework (pages → sections → fields)
- capability-based access rules
(WordPress does menus + capability checks; mirror the concept in-app). 

B1) Implement an Admin Module Registry:
Create client/admin/modules/registry.ts that supports:
registerAdminModule({
  id,
  title,
  icon,
  route,
  navGroup,
  capability,            // e.g., admin:read, admin:write, trading:write
  settingsSchema?,       // optional: defines fields/sections
  healthChecks?          // optional: endpoints to test
})

B2) Implement RBAC / capabilities:
- Minimal: user role → capability list
- Enforce in BOTH backend endpoints + frontend route guards
- Make it easy to expand later.

B3) Implement Settings framework:
- Admin Settings page reads module settingsSchema and renders pages → sections → fields automatically.
- Persistence:
  - Store settings in DB (admin_settings table) keyed by moduleId + key
  - Also allow env override for secrets (API keys stay env, not DB).

B4) Implement Global Admin Search:
- Search across: traceId, decisionId, work_item id, orderId, brokerOrderId, symbol
- Search results link to relevant admin pages.

========================================================
PHASE C — ADMIN APIS (MUST BE REAL, WITH SOURCE METADATA)
========================================================
Implement backend routes (server/admin/*):
All responses must include:
{ source: "db"|"alpaca"|"computed", fetchedAt, isStale?, cacheAgeMs? }

C1) System Overview:
GET /api/admin/overview
- orchestrator last run, next scheduled run, mode (paper/live disabled), open positions count
- queue depth, dead letters count, oldest pending age
- LLM call counts by provider/model/role (last 24h)
- provider budgets: used vs limit
- error rate and last 20 errors (structured)

C2) Orchestrator Control:
GET /api/admin/orchestrator/status
POST /api/admin/orchestrator/pause
POST /api/admin/orchestrator/resume
POST /api/admin/orchestrator/run-now
- Must actually control the orchestrator loops.

C3) Work Queue Console:
GET /api/admin/work-queue/items?status=...&type=...
POST /api/admin/work-queue/items/:id/retry
POST /api/admin/work-queue/items/:id/dead-letter
POST /api/admin/work-queue/items/:id/cancel
- Ensure idempotency + audit logging.

C4) Providers/Budgets/Caches:
GET /api/admin/providers
POST /api/admin/providers/:id/toggle
POST /api/admin/providers/:id/limits
GET /api/admin/cache/entries?provider=...&symbol=...
POST /api/admin/cache/invalidate

C5) LLM Router Console:
GET /api/admin/llm/router-config
POST /api/admin/llm/router-config
GET /api/admin/llm/calls?role=...&provider=...
- Must reflect OpenAI + OpenRouter routing reality (already integrated).

C6) Trading Truth Console:
GET /api/admin/trading/decisions
GET /api/admin/trading/orders
GET /api/admin/trading/fills
GET /api/admin/trading/positions (from Alpaca)
POST /api/admin/trading/reconcile (sync broker state → DB audit)

If G4 is not yet implemented, the UI MUST show a red banner “G4 pending: orders/fills tables missing” with link to backlog item, not fake data.

========================================================
PHASE D — OBSERVABILITY INSTRUMENTATION (OPEN TELEMETRY)
========================================================
Add OpenTelemetry instrumentation for Node.js server:
- traces + metrics (logs optional depending on current stack)
- attach traceId to spans/log contexts
- export:
  - dev: console exporter
  - prod: OTEL Collector endpoint (configurable)

Implement:
- auto-instrumentation for Express/HTTP
- custom spans for:
  orchestrator cycle
  work item run
  LLM call
  broker request

Add docs:
- docs/OBSERVABILITY.md updates with “how to run OTel locally” and “OTel Collector config”
- Provide a minimal Grafana Loki pipeline example (optional) for logs.

========================================================
PHASE E — TRADE FORENSICS (WHAT WENT RIGHT/WRONG)
========================================================
Create a forensic analysis report and admin view.

E1) Add DB query + report generator:
- docs/TRADE_FORENSICS_REPORT.md regenerated via script scripts/generate-forensics.ts
Report must include:
- stuck work items
- duplicate idempotency collisions (counts)
- decisions with no execution attempt
- orders (or trades) with missing broker confirmation
- fill anomalies (if fills exist)
- latency distribution: decision→submit, submit→fill

E2) Add Admin page “Forensics”:
- charts (simple)
- top anomaly tables
- recommended actions buttons: “reconcile”, “retry”, “disable provider”, “pause orchestrator”

========================================================
PHASE F — CLEANUP: UNUSED/BROKEN PARTS (SAFE REFACTOR)
========================================================
- Identify repeated/broken UI components
- Consolidate into canonical components:
  - OrdersTable, DecisionsTable, WorkItemsTable, ProviderTable, LlmCallsTable
- Remove dead routes or mark as deprecated with clear label.

========================================================
PHASE G — PROOF OF WORK (MANDATORY)
========================================================
At end:
1) git diff --stat
2) commands:
   - npm run check:types
   - npm run lint (if exists)
3) show 6 real endpoint outputs (curl) for the new admin APIs
4) show Admin UI routes working (list the routes)
5) update docs/INDEX.md (or equivalent) to include Admin Center usage and how it maps to modules.

IMPORTANT: This task is Admin Center + Observability + Compliance Map. Do not attempt to fully build scraping/social listeners here unless docs explicitly mark it as immediate.

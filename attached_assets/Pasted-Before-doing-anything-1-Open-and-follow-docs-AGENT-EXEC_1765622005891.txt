Before doing anything:

1. Open and follow docs/AGENT_EXECUTION_GUIDE.md as the primary governance document for this repo.
2. When the guide instructs you to consult other docs (such as:
   - docs/APP_OVERVIEW.md
   - docs/ARCHITECTURE.md
   - docs/ORCHESTRATOR_AND_AGENT_RUNTIME.md
   - docs/AI_MODELS_AND_PROVIDERS.md
   - docs/CONNECTORS_AND_INTEGRATIONS.md
   - docs/FINANCIAL_METRICS.md
   - docs/TESTING.md
   - docs/OBSERVABILITY.md
   - docs/LESSONS_LEARNED.md
   - any other .md files in docs/
   ),
   open and follow those sections before starting the task.

3. Classify this task as:
   - Type: DOCUMENTATION REFACTOR & CONSOLIDATION (no functional code changes).
   - Priority: HIGH (governance + onboarding + future development).
   - Goal: Make docs lighter to read, non-duplicated, and aligned with actual code & architecture.

You are allowed to:
- Reorganize, move, merge, and **delete clearly redundant** or outdated documentation content.
- Create new docs or split huge docs into smaller focused ones.
- Adjust headings and cross-links.
You are NOT allowed to:
- Change production behavior, business logic, or external API contracts.
- Remove unique information that has no surviving canonical copy elsewhere.

==================================================
PHASE A – DISCOVERY & PLAN (READ-ONLY FIRST)
==================================================

1) Inventory all docs
- List all Markdown files under docs/ and any subfolders, including:
  - Core governance & overview docs: AGENT_EXECUTION_GUIDE, APP_OVERVIEW, ARCHITECTURE, ORCHESTRATOR_AND_AGENT_RUNTIME, AI_MODELS_AND_PROVIDERS, CONNECTORS_AND_INTEGRATIONS, FINANCIAL_METRICS, TESTING, OBSERVABILITY, LESSONS_LEARNED.
  - Any additional docs (e.g. ROADMAP, BENCHMARKING, service specs, ADRs, etc.).
- For each file, capture (internally, no need to persist as a file):
  - Purpose (what this doc is supposed to do).
  - Intended audience (devs, PM, DevOps, AI/orchestration, etc.).
  - Rough size/complexity.
  - Major overlapping topics (e.g., architecture, AI usage, connectors, P&L, orchestrator, tests).

2) Scan the current code & behavior
- At a high level, inspect:
  - The backend modules (orchestrator, trading engine, Alpaca connector, market data connectors, persistence/repositories, risk & P&L logic).
  - The frontend screens (dashboard, analytics, strategy builder, positions/trades, settings) and how they fetch data.
  - The testing setup (unit/integration/E2E) and where tests actually live.
  - The logging/observability utilities.
  - AI integrations and provider abstraction layer.
- Note mismatches where docs:
  - Describe features that no longer exist, or
  - Miss features that now exist.

3) Build a refactor plan (BEFORE editing)
- Create a short internal plan (as your next reply to me) that includes:
  - Which doc is the **canonical source** for each topic:
    - System & product overview (APP_OVERVIEW).
    - Architecture (ARCHITECTURE, plus C4-style views).
    - Orchestrator runtime (ORCHESTRATOR_AND_AGENT_RUNTIME).
    - AI models & usage (AI_MODELS_AND_PROVIDERS).
    - Connectors & integrations (CONNECTORS_AND_INTEGRATIONS + provider capability docs).
    - Financial metrics & P&L definitions (FINANCIAL_METRICS).
    - Testing strategy & backlogs (TESTING).
    - Observability/logging/monitoring (OBSERVABILITY).
    - Continuous learning/retro (LESSONS_LEARNED).
    - Roadmap/benchmarking (ROADMAP / BENCHMARKING, if present).
  - Where repeated content exists and which doc will become the canonical home for it.
  - Which new docs you will create (for example):
    - docs/INDEX.md or docs/README.md – a “front door / quick start for humans & agents”.
    - docs/API_REFERENCE.md – central REST/HTTP API list & references to event schemas.
  - Which types of redundancies or outdated sections you plan to remove or compress.

Only after you’ve built and “mentally agreed” this plan, start editing.

==================================================
PHASE B – CREATE A SINGLE FRONT DOOR (INDEX)
==================================================

4) Create docs/INDEX.md (or docs/README.md if preferred)
- Purpose: Be the **one-page entry point** for humans and agents.
- Content:
  - Very short description of the app.
  - “If you are a developer and you want to change code, read:”
    - AGENT_EXECUTION_GUIDE → ARCHITECTURE → TESTING → OBSERVABILITY.
  - “If you are adding a connector or market data provider, read:”
    - CONNECTORS_AND_INTEGRATIONS → provider capability docs → TESTING.
  - “If you are touching AI, read:”
    - AI_MODELS_AND_PROVIDERS → ORCHESTRATOR_AND_AGENT_RUNTIME → FINANCIAL_METRICS (for numeric context) → TESTING.
  - “If you are just onboarding, read in order:”
    - APP_OVERVIEW → ARCHITECTURE → ORCHESTRATOR_AND_AGENT_RUNTIME.
- Make this page **short and scannable**.

5) Update AGENT_EXECUTION_GUIDE.md to reference INDEX
- At the top, add a tiny **“Quick Checklist”**:
  - Task classification → Relevant docs → Plan → Implement → Test → Document → Update LESSONS_LEARNED.
- Add a short bullet:
  - “For navigation and entry points, see docs/INDEX.md.”

==================================================
PHASE C – CLEAN UP & CONSOLIDATE EACH MAJOR DOC
==================================================

For each major doc below, follow this pattern:
- Keep unique content.
- Move truly duplicated content into a single canonical home.
- Replace removed duplicates with short summaries + links.
- Add small “Old vs New / Implementation Status” blocks where useful.
- You are allowed to **delete** duplicated paragraphs once their content is safely represented in the canonical location.

6) docs/APP_OVERVIEW.md
- Make this the **canonical product + system overview**:
  - What the app is, who it’s for, key features, high-level flow (user → orchestrator → trading → metrics).
- Remove or compress low-level technical details that are better suited to ARCHITECTURE, ORCHESTRATOR, or AI/CONNECTORS docs.
- Add a “Quick Start for Humans & Agents” section near the top that:
  - Points to INDEX for navigation.
  - Points to key docs for more depth.
- Keep “Old vs New / Enhancements” but ensure it is concise and not a duplicate of ARCHITECTURE’s similar section.

7) docs/ARCHITECTURE.md
- Make this the **canonical technical architecture doc**, aligned with C4 best practices:
  - Context view (system and external actors).
  - Container view (frontend, backend, data stores, external systems).
  - Component/service view where critical (or link to service docs / ADRs).
- Remove repeated high-level product explanations already covered in APP_OVERVIEW; replace with a short link back.
- For any microservices content:
  - Add **clear status labels** for each piece:
    - “Status: implemented / partially implemented / planned.”
- Ensure links to any service-specific docs (e.g., docs/services/...) and to EVENT_SCHEMA_REGISTRY are accurate.

8) docs/ORCHESTRATOR_AND_AGENT_RUNTIME.md
- Keep this focused on **runtime behavior**:
  - Orchestrator cycles.
  - Agent modes and transitions.
  - Risk/kill-switch logic.
  - Event flows (and references to EVENT_SCHEMA_REGISTRY).
- Remove generic architecture content duplicated from ARCHITECTURE and replace with short links.
- Add a small “Old vs New Orchestrator Behavior” section summarizing how behavior improved (safety, reliability).

9) docs/AI_MODELS_AND_PROVIDERS.md
- Make this the **single canonical AI integration doc**:
  - Which providers are used (OpenAI/OpenRouter/etc.).
  - What tasks they perform (signals, explanations, Q&A, etc.).
  - Prompting patterns, cost-control strategies, safety rules.
- If AI usage descriptions appear in other docs (APP_OVERVIEW, ORCHESTRATOR), keep only short summaries there and link back here.
- Mark each provider and model with:
  - Status: in use / experimental / planned.
  - Key constraints (rate limits, cost notes).

10) docs/CONNECTORS_AND_INTEGRATIONS.md (+ provider capability docs)
- Turn this into the **canonical connector inventory**:
  - For each connector (Alpaca, Finnhub, CoinGecko, etc.):
    - Purpose (what data it provides).
    - Key endpoints used.
    - Status: implemented / partial / planned.
  - Link to provider-specific capability docs (e.g., providers/ALPACA_CAPABILITIES.md) for deeper details.
- Remove or compress any connector descriptions that are duplicated in other docs; replace with links.
- If some provider capabilities are clearly “Not Yet Implemented”, ensure that is:
  - Marked here.
  - Also reflected in roadmap/testing docs (not scattered in multiple places with inconsistent wording).

11) docs/FINANCIAL_METRICS.md
- Keep this as the **single source of truth** for:
  - P&L formulas (unrealized, realized, total).
  - Performance metrics (win rate, profit factor, etc.).
  - Risk metrics.
- Ensure:
  - Any metrics marked “Not Yet Implemented” truly are missing from code.
  - Metrics that are now implemented are re-labeled accordingly, and point to code modules that implement them.
- If metric explanations are repeated in APP_OVERVIEW/ARCHITECTURE, shorten them and link back here.
- Add a short “Implementation Status Table”:
  - For each metric: {Name, Implemented (Y/N), Used in UI (Y/N), Tested (Y/N)}.

12) docs/TESTING.md
- Keep this as the **canonical testing strategy & backlog**:
  - Testing philosophy.
  - Types of tests (unit, integration, E2E).
  - Critical flows that MUST be tested (trading, orchestrator, P&L, connectors).
- Consolidate all scattered TODO/“Not Yet Implemented tests” into one backlog table here.
- Remove duplicate copies of testing philosophy from other docs.
- Where other docs mention test gaps, reference this table instead of repeating details.

13) docs/OBSERVABILITY.md
- Make this the **canonical doc for logs/metrics/tracing**:
  - Log levels and categories.
  - Structure/format of logs (including correlation IDs, redaction rules).
  - Any monitoring/export expectations.
- Remove repeated logging descriptions from other docs; replace with a short “see OBSERVABILITY” note.
- If you plan centralized log aggregation in microservices future, describe high-level expectations here.

14) docs/LESSONS_LEARNED.md
- Keep all existing lessons (no deletions).
- For each lesson or group, add:
  - A timestamp or version label.
  - Short tags (e.g., [P&L], [Testing], [AI], [Docs]) to help searching.
- If any lessons are now fully addressed by new processes in AGENT_EXECUTION_GUIDE or TESTING, add a small note referencing the fix.

15) Any other docs (ROADMAP, BENCHMARKING, service specs, ADRs, etc.)
- ROADMAP / MoSCoW:
  - Ensure that “Not Yet Implemented” items from FINANCIAL_METRICS, TESTING, AI, and CONNECTORS are represented here instead of being scattered.
- BENCHMARKING:
  - Keep competitor analysis but ensure proposed features link into ROADMAP.
- Service docs (docs/services/*.md, if present):
  - Keep them narrowly focused on that service’s responsibilities, APIs, and events.
  - Remove generic architecture explanations already covered in ARCHITECTURE; link to it instead.
- ADRs (docs/adr/*):
  - Leave structure as-is but ensure major decisions are referenced from ARCHITECTURE and APP_OVERVIEW where relevant.

==================================================
PHASE D – CREATE CENTRAL API REFERENCE
==================================================

16) Create docs/API_REFERENCE.md
- Purpose: one place to see all external interfaces.
- Include:
  - High-level list of REST/HTTP endpoints:
    - Grouped by domain (trading, orchestrator, analytics, admin, etc.).
    - For each: method, path, purpose, and link to the service doc or code file.
  - A short section linking to EVENT_SCHEMA_REGISTRY for event-based interfaces:
    - For major events, indicate producer/consumer and link to their definitions.
- Avoid duplicating detailed examples that are already in service docs; instead, link.

17) Update other docs to reference API_REFERENCE
- In ARCHITECTURE, ORCHESTRATOR, APP_OVERVIEW, and service docs:
  - Where endpoints are mentioned, point to API_REFERENCE for the canonical list.

==================================================
PHASE E – QUALITY PASS & FINAL CHECK
==================================================

18) Consistency & duplication check
- Run a final pass across major docs to:
  - Ensure there is only **one canonical detailed explanation** for each major topic:
    - Overview → APP_OVERVIEW
    - Architecture → ARCHITECTURE
    - Orchestrator runtime → ORCHESTRATOR_AND_AGENT_RUNTIME
    - AI usage → AI_MODELS_AND_PROVIDERS
    - Connectors → CONNECTORS_AND_INTEGRATIONS + provider docs
    - Metrics → FINANCIAL_METRICS
    - Testing → TESTING
    - Observability → OBSERVABILITY
    - Lessons → LESSONS_LEARNED
  - Replace any remaining duplicated blocks with:
    - A short summary.
    - A “See X for full details” link.

19) Implementation status labels
- For any place where:
  - Microservices are described,
  - Connectors/providers are listed,
  - Metrics/tests/features are defined,
  add a small “Status” indicator so readers know if it is:
  - Implemented, Partially implemented, Planned, or Deprecated.

20) Links & navigation
- Verify that:
  - All internal links between docs are valid.
  - INDEX/README is the visible top entry point.
  - AGENT_EXECUTION_GUIDE clearly references INDEX and the main docs.

21) Lessons learned from this refactor
- Append a short entry to docs/LESSONS_LEARNED.md summarizing:
  - What was changed in the documentation structure.
  - What worked well (e.g., central API_REFERENCE, INDEX).
  - Any guidelines for future doc updates (e.g., “before adding a new section, first check if a canonical home exists”).

==================================================
EXECUTION RULES
==================================================

- Keep this work **documentation-only**; only touch code for:
  - Updating comments that explicitly contradict the new docs, or
  - Fixing broken documentation references (e.g., JSDoc pointing to renamed docs).
- Prefer:
  - Shorter, clearer docs with links over long repeated text.
  - C4-style layered views for architecture: context → containers → components → code.
- Every major edit should move the docs closer to:
  - Less duplication.
  - Clear canonical homes for each topic.
  - Easier onboarding for both human engineers and AI agents.

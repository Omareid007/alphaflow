{
  "metadata": {
    "generated": "2025-01-01T00:00:00Z",
    "version": "1.0.0",
    "source": "AI Active Trader Codebase Analysis",
    "lastUpdated": "2025-01-01"
  },

  "projectStats": {
    "totalModules": 130,
    "documentationFiles": 60,
    "llmProviders": 6,
    "microservices": 7,
    "tradingStrategies": 3,
    "externalConnectors": 15,
    "databaseTables": 35,
    "supportedSymbols": 39,
    "apiEndpoints": 45
  },

  "llmProviders": [
    {
      "name": "OpenAI",
      "models": ["gpt-4o", "gpt-4o-mini", "gpt-4-turbo"],
      "costPer1kTokens": {
        "gpt-4o": { "input": 0.005, "output": 0.015 },
        "gpt-4o-mini": { "input": 0.00015, "output": 0.0006 },
        "gpt-4-turbo": { "input": 0.01, "output": 0.03 }
      },
      "rateLimit": 60,
      "rateLimitUnit": "per_minute"
    },
    {
      "name": "Anthropic",
      "models": ["claude-3-opus", "claude-3-sonnet", "claude-3-haiku"],
      "costPer1kTokens": {
        "claude-3-opus": { "input": 0.015, "output": 0.075 },
        "claude-3-sonnet": { "input": 0.003, "output": 0.015 },
        "claude-3-haiku": { "input": 0.00025, "output": 0.00125 }
      },
      "rateLimit": 50,
      "rateLimitUnit": "per_minute"
    },
    {
      "name": "Groq",
      "models": ["llama-3.1-70b", "llama-3.1-8b", "mixtral-8x7b"],
      "costPer1kTokens": {
        "llama-3.1-70b": { "input": 0.00059, "output": 0.00079 },
        "llama-3.1-8b": { "input": 0.00005, "output": 0.00008 },
        "mixtral-8x7b": { "input": 0.00024, "output": 0.00024 }
      },
      "rateLimit": 30,
      "rateLimitUnit": "per_minute"
    },
    {
      "name": "Together.ai",
      "models": ["llama-3.1-405b", "mistral-7b", "codellama-34b"],
      "costPer1kTokens": {
        "llama-3.1-405b": { "input": 0.005, "output": 0.015 },
        "mistral-7b": { "input": 0.0002, "output": 0.0002 },
        "codellama-34b": { "input": 0.0008, "output": 0.0008 }
      },
      "rateLimit": 60,
      "rateLimitUnit": "per_minute"
    },
    {
      "name": "AIML",
      "models": ["deepseek-r1", "deepseek-coder"],
      "costPer1kTokens": {
        "deepseek-r1": { "input": 0.00055, "output": 0.00219 },
        "deepseek-coder": { "input": 0.00014, "output": 0.00028 }
      },
      "rateLimit": 30,
      "rateLimitUnit": "per_minute"
    },
    {
      "name": "OpenRouter",
      "models": ["auto", "various-models"],
      "costPer1kTokens": {
        "auto": { "input": 0.001, "output": 0.002 }
      },
      "rateLimit": 60,
      "rateLimitUnit": "per_minute"
    }
  ],

  "roleBasedRouting": {
    "news_summarizer": {
      "preferredProvider": "groq",
      "model": "llama-3.1-8b",
      "fallback": "gpt-4o-mini",
      "expectedCallsPerDay": 100,
      "avgTokensPerCall": 500,
      "cacheTTL": 3600
    },
    "technical_analyst": {
      "preferredProvider": "aiml",
      "model": "deepseek-r1",
      "fallback": "gpt-4o-mini",
      "expectedCallsPerDay": 50,
      "avgTokensPerCall": 1000,
      "cacheTTL": 300
    },
    "risk_manager": {
      "preferredProvider": "openai",
      "model": "gpt-4o-mini",
      "fallback": "claude-3-haiku",
      "expectedCallsPerDay": 30,
      "avgTokensPerCall": 800,
      "cacheTTL": 600
    },
    "execution_planner": {
      "preferredProvider": "openai",
      "model": "gpt-4o-mini",
      "fallback": "groq",
      "expectedCallsPerDay": 50,
      "avgTokensPerCall": 600,
      "cacheTTL": 60
    },
    "post_trade_reporter": {
      "preferredProvider": "groq",
      "model": "llama-3.1-8b",
      "fallback": "gpt-4o-mini",
      "expectedCallsPerDay": 20,
      "avgTokensPerCall": 400,
      "cacheTTL": 1800
    }
  },

  "tradingStrategies": {
    "momentum": {
      "displayName": "Momentum Strategy",
      "description": "Trend-following strategy based on price momentum and RSI",
      "parameters": {
        "lookbackPeriod": { "min": 5, "max": 30, "default": 14, "unit": "days" },
        "momentumThreshold": { "min": 0.005, "max": 0.10, "default": 0.02, "unit": "percent" },
        "rsiPeriod": { "min": 5, "max": 21, "default": 14, "unit": "days" },
        "rsiOverbought": { "min": 60, "max": 85, "default": 70, "unit": "level" },
        "rsiOversold": { "min": 15, "max": 40, "default": 30, "unit": "level" },
        "allocationPct": { "min": 0.02, "max": 0.20, "default": 0.08, "unit": "percent" },
        "riskLimitPct": { "min": 0.02, "max": 0.15, "default": 0.05, "unit": "percent" }
      },
      "presets": ["conservative", "moderate", "aggressive", "scalper", "swing", "daytrader"]
    },
    "maCrossover": {
      "displayName": "MA Crossover Strategy",
      "description": "Golden/Death cross strategy using fast and slow moving averages",
      "parameters": {
        "fastPeriod": { "min": 3, "max": 20, "default": 7, "unit": "days" },
        "slowPeriod": { "min": 10, "max": 60, "default": 20, "unit": "days" },
        "allocationPct": { "min": 0.01, "max": 0.25, "default": 0.10, "unit": "percent" },
        "riskLimitPct": { "min": 0.02, "max": 0.30, "default": 0.10, "unit": "percent" }
      },
      "presets": ["conservative", "moderate", "aggressive", "scalper", "swing", "daytrader"]
    },
    "meanReversion": {
      "displayName": "Mean Reversion Scalper",
      "description": "Statistical mean reversion using Bollinger Bands and standard deviation",
      "parameters": {
        "lookbackPeriod": { "min": 5, "max": 50, "default": 14, "unit": "days" },
        "deviationThreshold": { "min": 1.0, "max": 4.0, "default": 2.0, "unit": "sigma" },
        "allocationPct": { "min": 0.01, "max": 0.15, "default": 0.05, "unit": "percent" },
        "riskLimitPct": { "min": 0.01, "max": 0.10, "default": 0.03, "unit": "percent" },
        "maxHoldingPeriod": { "min": 1, "max": 10, "default": 3, "unit": "days" }
      },
      "presets": ["conservative", "moderate", "aggressive", "scalper", "swing", "daytrader"]
    }
  },

  "riskManagement": {
    "current": {
      "maxPositionSizePercent": 10,
      "maxTotalExposurePercent": 50,
      "maxPositionsCount": 10,
      "dailyLossLimitPercent": 5,
      "maxDrawdownPercent": 20
    },
    "recommended": {
      "maxPositionSizePercent": 8,
      "maxTotalExposurePercent": 80,
      "maxPositionsCount": 20,
      "dailyLossLimitPercent": 3,
      "maxDrawdownPercent": 15
    }
  },

  "apiRateLimits": [
    { "provider": "Alpaca", "limit": 180, "unit": "per_minute", "cacheTTL": 30 },
    { "provider": "Finnhub", "limit": 50, "unit": "per_minute", "cacheTTL": 60 },
    { "provider": "TwelveData", "limit": 6, "unit": "per_minute", "dailyLimit": 700, "cacheTTL": 300 },
    { "provider": "CoinGecko", "limit": 10, "unit": "per_minute", "dailyLimit": 500, "cacheTTL": 60 },
    { "provider": "NewsAPI", "limit": 100, "unit": "per_day", "cacheTTL": 3600 },
    { "provider": "GDELT", "limit": 60, "unit": "per_minute", "cacheTTL": 900 },
    { "provider": "Alpha Vantage", "limit": 5, "unit": "per_minute", "dailyLimit": 500, "cacheTTL": 300 }
  ],

  "supportedSymbols": {
    "stocks": [
      "AAPL", "MSFT", "GOOGL", "AMZN", "NVDA", "META", "TSLA", "JPM", "V", "UNH",
      "JNJ", "WMT", "PG", "MA", "HD", "CVX", "ABBV", "MRK", "KO", "PEP",
      "COST", "TMO", "AVGO", "ORCL", "ACN", "MCD", "CSCO", "ABT", "AMD", "INTC",
      "IBM", "CRM", "NFLX", "ADBE", "PYPL", "DIS"
    ],
    "crypto": [
      "BTC/USD", "ETH/USD", "SOL/USD"
    ],
    "total": 39
  },

  "microservices": [
    {
      "name": "API Gateway",
      "port": 5000,
      "resources": { "cpu": "100m-500m", "memory": "256-512Mi" },
      "description": "Main entry point, authentication, rate limiting"
    },
    {
      "name": "Trading Engine",
      "port": 3001,
      "resources": { "cpu": "100m-500m", "memory": "256-512Mi" },
      "description": "Order execution, position management"
    },
    {
      "name": "AI Decision Service",
      "port": 3002,
      "resources": { "cpu": "200m-750m", "memory": "512-768Mi" },
      "description": "LLM gateway, role-based routing"
    },
    {
      "name": "Market Data Service",
      "port": 3003,
      "resources": { "cpu": "100m-500m", "memory": "256-512Mi" },
      "description": "Price feeds, technical indicators"
    },
    {
      "name": "Analytics Service",
      "port": 3004,
      "resources": { "cpu": "100m-500m", "memory": "256-512Mi" },
      "description": "Performance metrics, reporting"
    },
    {
      "name": "Orchestrator",
      "port": 3005,
      "resources": { "cpu": "100m-500m", "memory": "256-512Mi" },
      "description": "Workflow coordination, cycle management"
    },
    {
      "name": "Event Bridge",
      "port": 4222,
      "resources": { "cpu": "100m", "memory": "256Mi" },
      "description": "NATS JetStream messaging"
    }
  ],

  "databaseTables": [
    "users", "strategies", "trades", "positions", "orders", "fills",
    "ai_decisions", "agent_status", "ai_decision_features", "ai_trade_outcomes",
    "ai_calibration_log", "llm_calls", "ai_agent_profiles", "ai_arena_runs",
    "ai_arena_agent_decisions", "ai_outcome_links", "work_items", "work_item_runs",
    "universe_assets", "universe_liquidity_metrics", "universe_fundamentals",
    "universe_technicals", "macro_indicators", "asset_classifications",
    "external_api_cache_entries", "external_api_usage_counters", "admin_settings",
    "connector_metrics", "strategy_versions", "backtestRuns", "backtestTradeEvents",
    "backtestEquityCurve", "debate_sessions", "debate_messages", "debate_consensus",
    "competition_runs", "competition_scores"
  ],

  "slaTargets": {
    "platformAvailability": "99.5%",
    "orderExecutionSuccess": "99.9%",
    "dataFreshness": "<5s",
    "orderSubmissionLatency": "<100ms",
    "dailyTokenBudget": "$50",
    "monthlyLLMLimit": "$1000"
  },

  "costEstimates": {
    "minimal": {
      "description": "Development/Testing Environment",
      "monthly": {
        "vps": 8,
        "domain": 1,
        "ssl": 0,
        "cdn": 0,
        "llm": 10,
        "marketData": 0,
        "total": 19
      }
    },
    "standard": {
      "description": "Production with Basic Features",
      "monthly": {
        "vps": 8,
        "domain": 1,
        "ssl": 0,
        "cdn": 0,
        "frontend": 20,
        "llm": 30,
        "marketData": 29,
        "mobile": 10,
        "total": 98
      }
    },
    "full": {
      "description": "Full Production Environment",
      "monthly": {
        "vps": 15,
        "domain": 1,
        "ssl": 0,
        "cdn": 0,
        "frontend": 20,
        "llm": 50,
        "marketData": 79,
        "mobile": 10,
        "monitoring": 20,
        "backup": 10,
        "total": 205
      }
    }
  },

  "llmDailyCostBreakdown": {
    "roles": [
      { "role": "news_summarizer", "model": "Groq Llama 3.1-8b", "costPer1k": 0.00005, "callsPerDay": 100, "dailyCost": 0.0025 },
      { "role": "technical_analyst", "model": "DeepSeek R1", "costPer1k": 0.00055, "callsPerDay": 50, "dailyCost": 0.055 },
      { "role": "risk_manager", "model": "GPT-4o-mini", "costPer1k": 0.00015, "callsPerDay": 30, "dailyCost": 0.0068 },
      { "role": "execution_planner", "model": "GPT-4o-mini", "costPer1k": 0.00015, "callsPerDay": 50, "dailyCost": 0.0075 },
      { "role": "post_trade_reporter", "model": "Groq Llama 3.1-8b", "costPer1k": 0.00005, "callsPerDay": 20, "dailyCost": 0.0008 }
    ],
    "totalDaily": 0.07,
    "totalMonthly": 2.10
  },

  "issuesRegistry": {
    "critical": [
      {
        "id": "C-001",
        "title": "Position Tracking Duality",
        "description": "Alpaca positions not synced with database",
        "files": ["server/trading/alpaca-trading-engine.ts", "server/orchestration/coordinator.ts"],
        "impact": "Portfolio value discrepancies, incorrect P&L"
      },
      {
        "id": "C-002",
        "title": "No Unified Data Orchestration",
        "description": "Multiple data fetchers without coordination",
        "files": ["server/orchestration/coordinator.ts", "server/connectors/"],
        "impact": "Rate limit violations, redundant API calls"
      }
    ],
    "high": [
      {
        "id": "H-001",
        "title": "Technical Indicator Redundancy",
        "description": "SMA/EMA/RSI duplicated in 4+ files",
        "files": ["server/strategies/*.ts", "server/lib/technical-indicators.ts"],
        "linesOfDuplication": 280
      },
      {
        "id": "H-002",
        "title": "Triple Sentiment Source Without Orchestration",
        "description": "GDELT, NewsAPI, HuggingFace not aggregated",
        "files": ["server/connectors/gdelt-connector.ts", "server/connectors/news-connector.ts"],
        "impact": "Conflicting sentiment signals"
      },
      {
        "id": "H-003",
        "title": "Duplicate Preset Logic",
        "description": "Same presets defined in each strategy file",
        "files": ["server/strategies/momentum-strategy.ts", "server/strategies/ma-crossover-strategy.ts"],
        "linesOfDuplication": 300
      }
    ],
    "medium": [
      {
        "id": "M-001",
        "title": "Dual Caching Systems",
        "description": "Order cache and API cache overlap",
        "files": ["server/services/external-api-cache.ts"],
        "impact": "Memory overhead, inconsistent TTLs"
      },
      {
        "id": "M-002",
        "title": "Dual Fundamental Data Sources",
        "description": "TwelveData and Alpha Vantage both active",
        "impact": "Unnecessary API costs"
      }
    ]
  },

  "hostingerKVM2Specs": {
    "cpu": "2 vCPU",
    "ram": "8 GB",
    "storage": "100 GB NVMe",
    "bandwidth": "8 TB",
    "price": "$8/month",
    "os": "Ubuntu 22.04 LTS",
    "recommended": {
      "postgres": { "sharedBuffers": "2GB", "workMem": "256MB", "maxConnections": 100 },
      "docker": "24.0+",
      "node": "20 LTS"
    }
  },

  "deploymentResources": {
    "total": {
      "cpu": "~1.2 cores",
      "memory": "~3 GB",
      "headroom": "0.8 cores / 5 GB"
    },
    "services": {
      "api_gateway": { "cpu": "100m-500m", "memory": "256-512Mi" },
      "trading_engine": { "cpu": "100m-500m", "memory": "256-512Mi" },
      "ai_decision": { "cpu": "200m-750m", "memory": "512-768Mi" },
      "market_data": { "cpu": "100m-500m", "memory": "256-512Mi" },
      "analytics": { "cpu": "100m-500m", "memory": "256-512Mi" },
      "orchestrator": { "cpu": "100m-500m", "memory": "256-512Mi" },
      "nats": { "cpu": "100m", "memory": "256Mi" },
      "redis": { "cpu": "50m", "memory": "128Mi" }
    }
  },

  "roadmap": {
    "phase0": {
      "name": "Foundation",
      "status": "completed",
      "items": ["Monolithic architecture", "3 strategies", "Paper trading", "React Native app"]
    },
    "phase1": {
      "name": "Stabilization",
      "status": "in_progress",
      "items": ["Position reconciliation", "Indicator consolidation", "Sentiment aggregator", "Unified caching"]
    },
    "phase2": {
      "name": "Microservices",
      "status": "planned",
      "items": ["Service extraction", "NATS messaging", "Docker orchestration", "API gateway"]
    },
    "phase3": {
      "name": "Enhancement",
      "status": "planned",
      "items": ["Walk-forward backtesting", "LLM response caching", "Real-time analytics", "Mobile push"]
    },
    "phase4": {
      "name": "Scale",
      "status": "planned",
      "items": ["Kubernetes deployment", "Multi-region", "Advanced ML models", "Social trading"]
    }
  }
}

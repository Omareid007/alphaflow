apiVersion: v1
kind: Secret
metadata:
  name: postgres-credentials
  namespace: ai-trader
  labels:
    app: postgres
type: Opaque
stringData:
  username: aitrader
  password: "${POSTGRES_PASSWORD}"
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: postgres-init
  namespace: ai-trader
data:
  01-init.sql: |
    -- Create per-service schemas
    CREATE SCHEMA IF NOT EXISTS trading;
    CREATE SCHEMA IF NOT EXISTS ai;
    CREATE SCHEMA IF NOT EXISTS analytics;
    CREATE SCHEMA IF NOT EXISTS orchestration;
    CREATE SCHEMA IF NOT EXISTS market_data;
    
    -- Grant permissions
    GRANT ALL PRIVILEGES ON SCHEMA trading TO aitrader;
    GRANT ALL PRIVILEGES ON SCHEMA ai TO aitrader;
    GRANT ALL PRIVILEGES ON SCHEMA analytics TO aitrader;
    GRANT ALL PRIVILEGES ON SCHEMA orchestration TO aitrader;
    GRANT ALL PRIVILEGES ON SCHEMA market_data TO aitrader;
